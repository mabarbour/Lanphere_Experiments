Pandoc.brew(system.file('examples/graphs.brew', package='pander'), output = tempfile(), convert = 'html')
Pandoc.brew(file="~/Documents/galls-parasitoids/review.RMD", output=tempfile(), convert="html", graph.hi.res=TRUE)
Pandoc.brew(file="~/Documents/galls-parasitoids/review.RMD", output="~/Documents/galls-parasitoids/reviewtest", convert="html", graph.hi.res=TRUE)
Pandoc.brew(file="~/Documents/galls-parasitoids/review.RMD", output=tempfile(), convert="html", graph.hi.res=TRUE)
Pandoc.brew(file="~/Documents/galls-parasitoids/review.test.txt", output=tempfile(), convert="pdf", graph.hi.res=TRUE)
Pandoc.brew(file="~/Documents/galls-parasitoids/review.test", output=tempfile(), convert="pdf", graph.hi.res=TRUE)
Pandoc.brew(file="~/Documents/galls-parasitoids/review.test", output=tempfile(), convert="pdf", graph.hi.res=TRUE)
install.packages("digest")
library("digest", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
Pandoc.brew(system.file('~/Documents/galls-parasitoids/review.Rmd', package='pander'), output=tempfile(), convert="pdf")
library("pander", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
Pandoc.brew(system.file('~/Documents/galls-parasitoids/review.Rmd', package='pander'), output=tempfile(), convert="pdf")
Pandoc.brew(system.file('~/Documents/galls-parasitoids/review.Rmd', package='pander'), output=tempfile(), convert='pdf')
options(rstudio.markdownToHTML =
function(review.Rmd, outputFile) {
system(paste("pandoc", shQuote(inputFile), "-o", shQuote(outputFile)))
}
)
library("markdown", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
install.packages("pander")
options(rstudio.markdownToHTML =
function(inputFile, outputFile) {
system(paste("pandoc", shQuote(inputFile), "-o", shQuote(outputFile)))
}
)
options
options(rstudio.markdownToHTML =
function(inputFile, outputFile) {
require(markdown)
markdownToHTML(inputFile, outputFile)
}
)
install.packages("sweave")
library("xtable", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
par(mfrow=c(2,1), mar=c(0,4,3,2)+0.1)
curve(splinefxn, 2,8, ylim=c(0,12), xlim=c(0,10), ylab="Gall Size", xlab="",lwd=3, las=1, xaxt="n")
abline(h=6, col=2, lty=2)
abline(h=8, col=2, lty=2)
as.data.frame(gallSpline) # use this to see where lines intersect on graph
abline(v=5, col=3, lty=3)
abline(v=5.65, col=3, lty=3)
# difference between vertical ablines suggest that this gall is only susceptible to this parasitoid species for 4.55 days or ~1/3 of a week.
## parasitoid density figure
par(mar=c(4,4,0,2)+0.1)
u <- 4 # mean weak of emergence
sd <- 1 # standard deviation
curve(1/(sqrt(2*3.14)*sd)*exp(-(x-u)^2/(2*sd^2)), from = 1, to = 8, ylab="Density", xlab="Time", ylim=c(0,0.6), xlim=c(0,10))
abline(v=4, col=1, lty=2)
abline(v=5, col=3, lty=3)
abline(v=5.65, col=3, lty=3)
# note that by looking at probability of a certain spline function surviving at different starts times, may give a good indication whether growth rate or emergence time is unders selection.
curve(splinefxn, 2,8, ylim=c(0,12), xlim=c(0,10), ylab="Gall Size", xlab="",lwd=3, las=1, xaxt="n")
time <- 2:8 # start 2 weeks after "beginning of season" with about a 6 week growth period
gallsize <- c(0,1,3,6,9,10,10)
gallSpline <- spline(time,gallsize)
splinefxn <- splinefun(time,gallsize) # need to see how I can get the actual function from this, mig
par(mfrow=c(2,1), mar=c(0,4,3,2)+0.1)
curve(splinefxn, 2,8, ylim=c(0,12), xlim=c(0,10), ylab="Gall Size", xlab="",lwd=3, las=1, xaxt="n")
abline(h=6, col=2, lty=2)
abline(h=8, col=2, lty=2)
as.data.frame(gallSpline) # use this to see where lines intersect on graph
abline(v=5, col=3, lty=3)
abline(v=5.65, col=3, lty=3)
# difference between vertical ablines suggest that this gall is only susceptible to this parasitoid species for 4.55 days or ~1/3 of a week.
## parasitoid density figure
par(mar=c(4,4,0,2)+0.1)
u <- 4 # mean weak of emergence
sd <- 1 # standard deviation
curve(1/(sqrt(2*3.14)*sd)*exp(-(x-u)^2/(2*sd^2)), from = 1, to = 8, ylab="Density", xlab="Time", ylim=c(0,0.6), xlim=c(0,10))
abline(v=4, col=1, lty=2)
abline(v=5, col=3, lty=3)
abline(v=5.65, col=3, lty=3)
par(mfrow=c(1,2))
web1 <- matrix(c(1,9,5,9,1,5), nrow=2, byrow=T)
web2 <- matrix(c(9,1,5,1,9,5), nrow=2, byrow=T)
rownames(web1) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web1) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
rownames(web2) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web2) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
community <- matrix(c(15,15,10,10,15,15,10,10), nrow=2, byrow=T)
colnames(community) <- c("Gall sp. 1", "Gall sp. 2", "Parasitoid sp. 1", "Parasitoid sp. 2")
rownames(community) <- c("Site 1", "Site 2")
site1 <- c("a) Site 1")
site2 <- c("b) Site 2")
visweb(web1, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site1)
visweb(web2, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site2)
print(community)
library(bipartite)
par(mfrow=c(1,2))
web1 <- matrix(c(1,9,5,9,1,5), nrow=2, byrow=T)
web2 <- matrix(c(9,1,5,1,9,5), nrow=2, byrow=T)
rownames(web1) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web1) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
rownames(web2) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web2) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
community <- matrix(c(15,15,10,10,15,15,10,10), nrow=2, byrow=T)
colnames(community) <- c("Gall sp. 1", "Gall sp. 2", "Parasitoid sp. 1", "Parasitoid sp. 2")
rownames(community) <- c("Site 1", "Site 2")
site1 <- c("a) Site 1")
site2 <- c("b) Site 2")
visweb(web1, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site1)
visweb(web2, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site2)
print(community)
visweb(web1, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site1)
visweb(web2, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site2)
print(community)
plot(community)
plot(community)
plot(print(community))
Titanic
plot(Titanic)
plotweb(web1)
plotweb(web2)
plotweb(web1)
text(0.5,2.5,labels=site1)
plotweb(web1)
text(0.5,2.5,labels=site1)
text(0.5,5,labels=site1)
plotweb(web1, main="Site 1")
plotweb(web1)
plotweb(web2)
plotweb(web1, add=T)
plotweb(web1)
plotweb(web1)
plotweb(web2)
par(mfrow=c(2,1))
web1 <- matrix(c(1,9,5,9,1,5), nrow=2, byrow=T)
web2 <- matrix(c(9,1,5,1,9,5), nrow=2, byrow=T)
rownames(web1) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web1) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
rownames(web2) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web2) <- c("Parasitoid sp. 1", "Parasitoid sp. 2", "Galls surviving")
community <- matrix(c(15,15,10,10,15,15,10,10), nrow=2, byrow=T)
colnames(community) <- c("Gall sp. 1", "Gall sp. 2", "Parasitoid sp. 1", "Parasitoid sp. 2")
rownames(community) <- c("Site 1", "Site 2")
site1 <- c("a) Site 1")
site2 <- c("b) Site 2")
visweb(web1, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site1)
visweb(web2, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site2)
print(community)
plotweb(web1)
plotweb(web1)
plotweb(web2)
par(mfrow=c(2,1))
web1 <- matrix(c(1,9,5,9,1,5), nrow=2, byrow=T)
web2 <- matrix(c(9,1,5,1,9,5), nrow=2, byrow=T)
rownames(web1) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web1) <- c("Ptoid sp. 1", "Ptoid sp. 2", "Galls surviving")
rownames(web2) <- c("Gall sp. 1", "Gall sp. 2")
colnames(web2) <- c("Ptoid sp. 1", "Ptoid sp. 2", "Galls surviving")
community <- matrix(c(15,15,10,10,15,15,10,10), nrow=2, byrow=T)
colnames(community) <- c("Gall sp. 1", "Gall sp. 2", "Ptoid sp. 1", "Ptoid sp. 2")
rownames(community) <- c("Site 1", "Site 2")
site1 <- c("a) Site 1")
site2 <- c("b) Site 2")
visweb(web1, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site1)
visweb(web2, type="none", text="interaction", plotsize=1)
text(0.5,2.5,labels=site2)
print(community)
plotweb(web1)
plotweb(web1)
plotweb(web2)
Species <- c(45, 329, 489)
Types <- c("Predators", "Herbivores", "Parasitoids")
plot(Species ~ Types)
SpeciesTypes <- cbind.data.frame(Species,Types)
plot(SpeciesTypes)
BritishInsectDiversity <- read.csv("~/Desktop/Parasitoid_Lecture/BritishInsectDiversity.csv")
viewData(BritishInsectDiversity)
plot(BritishInsectDiversity)
plot(Predators)
plot(BritishInsectDiversity$Predators)
with(BritishInsectDiversity, plot(Predators + Herbivores + Parasitoids))
c1 <- rep("Predators",45)
c1
c2 <- rep("Herbivores",329)
c3 <- rep("Parasitoids",489)
data <- rbind(c1,c2,c3)
data <- c(c1,c2,c3)
data
plot(data)
plot.factor(data)
data <- as.factor(data)
plot(data)
plot(data, main = "Species Diversity of British Insects")
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500))
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), type="S")
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cexlab=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.lab=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.lab=3, cex.axis=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.lab=3, cex.axis=3, cex.main=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.lab=3, cex.axis=3, cex.main=3, cex.sub=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.axis=3, cex.main=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex.lab = 3, cex.axis=3, cex.main=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex=3, cex.axis=3, cex.main=3)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500), cex=2, cex.axis=2, cex.main=2)
plot(data, main = "Species Diversity of British Insects", ylim=c(0,500))
require(knitr)
require(markdown)
knit('test.rmd', 'test.md')
ssCR
source('~/Dropbox/FoodWebs/Models.R')
ssCR
r <- 0.6
K <- 10.0
e <- 0.8
m <- 0.5
Ro <- 1.0
Tau <- 2.7
R <- 0.6
Time <- 25
p.ssCR <- c(r = r, K = K, e = e, m = m, Ro = Ro, Tau = Tau)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
library(deSolve)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
r <- 0.6
K <- 10.0
e <- 0.8
m <- 0.5
Ro <- 1.0
Tau <- 2.7
a <- 1.0 # not mentioned in McCann's book
R <- 0.6
Time <- 25
p.ssCR <- c(r = r, K = K, e = e, m = m, Ro = Ro, Tau = Tau)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
ssCR.1
#### This script analyzes arthropod data collected from my wind experiment
# set working directory and load required libraries
setwd("~/Documents/Lanphere_Experiments/data")
library("vegan")
library("BiodiversityR")
library("mvabund")
library("MASS")
library("bipartite")
# source in managed data sets
source('wind_manage_arthropod_dissection_data.R')
source('wind_manage_visual_arthropod_surveys.R')
source('wind_manage_plant_trait_data.R')
###### Merge and manage data sets
# merge all of the arthropod and plant info data together
all_arthropods <- merge(arthropod_wind_visual_data_2012, compact_wind_miners, by.x = "plant_code", by.y = "ID_plant_miners", all.x=TRUE)
all_arthropods <- merge(all_arthropods, compact_wind_ties, by.x = "plant_code", by.y = "ID_plant_ties", all.x = TRUE)
# change all of the NA's in the columns to zeros.  These actually reflect real zeros but the reason for the NA's is because of an artifact from merging the data sets together
all_arthropods[ ,7:31][is.na(all_arthropods[ ,7:31])] <- 0
# focus on herbivore columns. Includes "ALL" instead of just living Caloptilia and tortricids
all_herbivore_data_frame <- with(all_arthropods, cbind.data.frame(leaf_hoppers_blue_brown, Leaf.Hoppers.Camo, Light.Green.Aphids, stem_gall, volcano_gall, mite_gall, yellow_knife_leaf_hopper, twisty_gall, giant_willow_aphid, psyllidae, sawflies, LH.nymph.other, aphid_species_used_in_ant_aphid_experiment, all_Caloptilia, all_tortricid))
all_arthropods$herbivore_rich <- specnumber(all_herbivore_data_frame)
all_arthropods$herbivore_abund <- rowSums(all_herbivore_data_frame)
# focus on predator/parasitoid columns
all_predator_data_frame <- with(all_arthropods, cbind.data.frame(Black.Ants,Red.ants,Spiders.black.with.yellow.legs, Spiders.Other, sp_327_LT.1, LTF_329, LEF_eulophid_cocoons, sp_323_all))
all_arthropods$enemy_rich <- specnumber(all_predator_data_frame)
all_arthropods$enemy_abund <- rowSums(all_predator_data_frame)
# arthropod richness and abundance in general
all_arthropods$all_rich <- all_arthropods$herbivore_rich + all_arthropods$enemy_rich
all_arthropods$all_abund <- all_arthropods$herbivore_abund + all_arthropods$enemy_abund
# predator/prey richness. added one to all values to deal with instances of zero species for herbivores.
all_arthropods$predator_prey_richness_ratio <- (all_arthropods$enemy_rich+1)/(all_arthropods$herbivore_rich + 1)
# all arthropods but no dead plants included.  Weird, but it is screwing up my ANOVA analysis, so right now I'm not comfortable using it.
no_dead_all_arthropods <- subset(all_arthropods, Dead. == 0)
########## Exploratory Plots
# richness
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, herbivore_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, enemy_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, predator_prey_richness_ratio, col=1:10, lwd=2))
# abundance
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, herbivore_abund, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, enemy_abund, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_abund, col=1:10, lwd=2))
# species specific abundances
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_Caloptilia, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, Light.Green.Aphids, col=1:10, lwd=2))
# multivariate abundances, note that the order is reversed along the y-axis (don't know why). Also, doesn't currently account for dead plants.
#herb_mvabund <- mvabund(all_herbivore_data_frame)
#boxplot(herb_mvabund)
#pred_mvabund <- mvabund(all_predator_data_frame)
#boxplot(pred_mvabund)
########## Data analysis. log and sqrt transformations aren't working with the data...DON'T FORGET THAT QUANTIFYING LINKS AND NETWORK SIZE, ETC. MAY BE A WAY TO EXTRACT MORE INFORMATION FROM SIMPLY RICHNESS OF DIFFERENT TROPHIC LEVELS.
# richness data
aov_herb_rich <- aov(log(herbivore_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_herb_rich)
aov_enemy_rich <- aov(log(enemy_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_enemy_rich)
aov_all_rich <- aov(log(all_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_all_rich)
aov_predator_prey_rich_ratio <- aov(log(predator_prey_richness_ratio + 1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_predator_prey_rich_ratio)
# abundance data
aov_herb_abund <- aov(log(herbivore_abund+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_herb_abund)
aov_enemy_abund <- aov(log(enemy_abund +1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_enemy_abund)
aov_all_abund <- aov(log(all_abund + 1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_all_abund)
aov_Caloptilia_abund <- aov(log(all_Caloptilia+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_Caloptilia_abund)
aov_Light.Green.Aphid_abund <- aov(Light.Green.Aphids ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_Light.Green.Aphid_abund)
# dissimilarity. NOTHING is showing through.  Possibly because I had to do the weird transformation of all zero values to create highly similar or dissimilar communities.
# transform all zero values
#bray_all_arthropods <- vegdist(no_dead_all_arthropods[ ,7:31], method="bray")
#no_zero_arthropod_dissimilarity <- dist.zeroes(no_dead_all_arthropods[ ,7:31], bray_all_arthropods)
#anosim_genotype_arthropods <- anosim(no_zero_arthropod_dissimilarity, all_arthropods$Genotype)
#anosim_exposure_arthropods <- anosim(no_zero_arthropod_dissimilarity, all_arthropods$Wind.Exposure)
###################### Caloptilia data set only
Caloptilia_only <- merge(arthropod_wind_visual_data_2012, sub_Caloptilia, by.x ="plant_code", by.y = "ID_plant_miners", all.x=TRUE)
Caloptilia_only[ ,24:28][is.na(Caloptilia_only[ ,24:28])] <- 0
omit_Caloptilia <- Caloptilia_only[-c(32,55), ]
Caloptilia_only <- merge(Caloptilia_only, sub_plant_traits, by = "plant_code")
###### plots of abundance of different stages. Abundance appears to switch between early and late instars
# summary data for fresh_gallery_mines
gallery_treatment_means <- aggregate(fresh_gallery_mine ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
gallery_exposure_means <- aggregate(fresh_gallery_mine ~ Wind.Exposure, data=gallery_treatment_means, mean)
gallery_exposure_sd <- aggregate(fresh_gallery_mine ~ Wind.Exposure, data=gallery_treatment_means, sd)
gallery_exposure_means$standard_error <- gallery_exposure_sd$fresh_gallery_mine/sqrt(10)
# interaction plot of fresh gallery mines
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=2, legend=F, ylab="Leaf mine Abundance", xlab=""))
# add summary points and error bars
points(x=0.95, gallery_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]+gallery_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]-gallery_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, gallery_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]+gallery_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]-gallery_exposure_means[2,3], angle=90, length=0.1)
# summary data for leaf tip folders
LTF_treatment_means <- aggregate(LTF_Caloptilia ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
LTF_exposure_means <- aggregate(LTF_Caloptilia ~ Wind.Exposure, data=LTF_treatment_means, mean)
LTF_exposure_sd <- aggregate(LTF_Caloptilia ~ Wind.Exposure, data=LTF_treatment_means, sd)
LTF_exposure_means$standard_error <- LTF_exposure_sd$LTF_Caloptilia/sqrt(10)
# interaction plot of leaf tip folders
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, LTF_Caloptilia, col=1:10, lwd=2, legend=F, ylab="Leaf tip fold Abundance", xlab=""))
# add summary points and error bars
points(x=0.95, LTF_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=LTF_exposure_means[1,2], x1=0.95, y1=LTF_exposure_means[1,2]+LTF_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=LTF_exposure_means[1,2], x1=0.95, y1=LTF_exposure_means[1,2]-LTF_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, LTF_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=LTF_exposure_means[2,2], x1=2.05, y1=LTF_exposure_means[2,2]+LTF_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=LTF_exposure_means[2,2], x1=2.05, y1=LTF_exposure_means[2,2]-LTF_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, LEF_Caloptilia, col=1:10, lwd=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, tent_mine_Caloptilia, col=1:10, lwd=2))
# Data analysis
aov_fresh_gallery <- aov(log(fresh_gallery_mine + 1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= Caloptilia_only)
summary(aov_fresh_gallery)
plot(fitted(aov_fresh_gallery[[4]]), studres(aov_fresh_gallery[[4]]))
abline(h=0, lty=2)
aov_LTF <- aov(log(LTF_Caloptilia +1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data=Caloptilia_only, qr=TRUE)
summary(aov_LTF)
plot(fitted(aov_LTF[[4]]), studres(aov_LTF[[4]]))
abline(h=0, lty=2)
###### plot plant traits
# mature green leaves
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, mature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Mature shoot growth (cm)", xlab=""))
# shoots sprouting at base
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Immature shoot growth (cm)", xlab=""))
###### analysis on plant traits
aov_mature_shoots <- aov(log(mature_shoot_total+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data=Caloptilia_only, qr=TRUE)
summary(aov_mature_shoots) # no genotype by environment interaction with mature shoot totals
plot(fitted(aov_mature_shoots[[4]]), studres(aov_mature_shoots[[4]]))
abline(h=0, lty=2)
aov_sprouts <- aov(log(immature_shoot_total+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data=Caloptilia_only, qr=TRUE)
summary(aov_sprouts)
plot(fitted(aov_sprouts[[4]]), studres(aov_sprouts[[4]]))
abline(h=0, lty=2)
###### look for correlations between plant traits and Caloptilia abundances
traits_Caloptilia_data <- aggregate(cbind(immature_shoot_total,mature_shoot_total, Mature.Green.Leaves, LTF_Caloptilia, fresh_gallery_mine) ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
# plot and look at correlations between leaf tip fold abundance versus mature green leaves
plot(LTF_Caloptilia ~ Mature.Green.Leaves, traits_Caloptilia_data)
cor.test(log(traits_Caloptilia_data$LTF_Caloptilia+1), log(traits_Caloptilia_data$Mature.Green.Leaves+1))
lm_LTF_leaves <- lm(log(traits_Caloptilia_data$LTF_Caloptilia+1) ~ log(traits_Caloptilia_data$Mature.Green.Leaves+1))
summary(lm_LTF_leaves) # mature leaf abundance explains about 20% of the variation.
# look at correlation with mature shoot total
plot(LTF_Caloptilia ~ mature_shoot_total, traits_Caloptilia_data)
cor.test(log(traits_Caloptilia_data$LTF_Caloptilia+1), log(traits_Caloptilia_data$mature_shoot_total+1))
lm_LTF_shoots <- lm(log(traits_Caloptilia_data$LTF_Caloptilia+1) ~ log(traits_Caloptilia_data$mature_shoot_total+1))
summary(lm_LTF_shoots) # mature shoot total explains about 23% of the variation
# look at correlation between mature shoot and immature shoots
plot(immature_shoot_total ~ mature_shoot_total, traits_Caloptilia_data)
cor.test(log(traits_Caloptilia_data$immature_shoot_total+1), log(traits_Caloptilia_data$mature_shoot_total+1)) # negative correlation between mature and immature shoot totals
plot(fresh_gallery_mine ~ LTF_Caloptilia, traits_Caloptilia_data)
cor.test(log(traits_Caloptilia_data$fresh_gallery_mine+1), log(traits_Caloptilia_data$LTF_Caloptilia+1)) # no negative correlation between abundances of early versus late larva instars.
# plot and look at correlations between gallery mine and sprouting shoots. Not looking great...
plot(fresh_gallery_mine ~ immature_shoot_total, traits_Caloptilia_data)
cor.test(log(traits_Caloptilia_data$fresh_gallery_mine+1), log(traits_Caloptilia_data$immature_shoot_total+1))
lm_gallery_sprouts <- lm(log(traits_Caloptilia_data$fresh_gallery_mine+1) ~ log(traits_Caloptilia_data$immature_shoot_total+1))
summary(lm_gallery_sprouts) # marginally significant effect.  only explains about 11% of the variance (adjusted R-squared)
# create new variables: sum early instars and later instars
#Caloptilia_only$early_instars <- Caloptilia_only$gallery_mine_Caloptilia + Caloptilia_only$tent_mine_Caloptilia
#Caloptilia_only$late_instars <- Caloptilia_only$LTF_Caloptilia + Caloptilia_only$LEF_Caloptilia
# plots of data
#with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, early_instars, col=1:10, lwd=2))
#with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, late_instars, col=1:10, lwd=2))
# interaction plot of fresh gallery mines
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=2, legend=F, ylab="Leaf mine Abundance", xlab=""))
# add summary points and error bars
points(x=0.95, gallery_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]+gallery_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]-gallery_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, gallery_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]+gallery_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]-gallery_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab=""))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", cex=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", cex.txt=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", cex.lab=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", cex.lab=1.5))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=3))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=4))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=1))
# interaction plot of fresh gallery mines
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=1))
# add summary points and error bars
points(x=0.95, gallery_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]+gallery_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]-gallery_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, gallery_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]+gallery_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]-gallery_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=T, ylab="Leaf mine Abundance", xlab="", las=1))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=1))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=T, ylab="Leaf mine Abundance", xlab="", las=1))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, fresh_gallery_mine, col=1:10, lwd=4, legend=F, ylab="Leaf mine Abundance", xlab="", las=1))
# add summary points and error bars
points(x=0.95, gallery_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]+gallery_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=gallery_exposure_means[1,2], x1=0.95, y1=gallery_exposure_means[1,2]-gallery_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, gallery_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]+gallery_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=gallery_exposure_means[2,2], x1=2.05, y1=gallery_exposure_means[2,2]-gallery_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, LTF_Caloptilia, col=1:10, lwd=2, legend=F, ylab="Leaf tip fold Abundance", xlab="", las=1))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, LTF_Caloptilia, col=1:10, lwd=3, legend=F, ylab="Leaf tip fold Abundance", xlab="", las=1))
# add summary points and error bars
points(x=0.95, LTF_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=LTF_exposure_means[1,2], x1=0.95, y1=LTF_exposure_means[1,2]+LTF_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=LTF_exposure_means[1,2], x1=0.95, y1=LTF_exposure_means[1,2]-LTF_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, LTF_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=LTF_exposure_means[2,2], x1=2.05, y1=LTF_exposure_means[2,2]+LTF_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=LTF_exposure_means[2,2], x1=2.05, y1=LTF_exposure_means[2,2]-LTF_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, mature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Mature shoot growth (cm)", xlab=""))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, mature_shoot_total, col=1:10, lwd=3, legend=F, ylab="Mature shoot growth (cm)", xlab="", las=1))
mature_shoot_treatment_means <- aggregate(mature_shoot_total ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
mature_shoot_exposure_means <- aggregate(mature_shoot_total ~ Wind.Exposure, data=gallery_treatment_means, mean)
mature_shoot_exposure_sd <- aggregate(mature_shoot_total ~ Wind.Exposure, data=gallery_treatment_means, sd)
mature_shoot_exposure_means$standard_error <- mature_shoot_exposure_sd$mature_shoot_total/sqrt(10)
str(Caloptilia_only)
mature_shoot_treatment_means <- aggregate(mature_shoot_total ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
mature_shoot_exposure_means <- aggregate(mature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, mean)
mature_shoot_exposure_sd <- aggregate(mature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, sd)
mature_shoot_exposure_means$standard_error <- mature_shoot_exposure_sd$mature_shoot_total/sqrt(10)
points(x=0.95, mature_shoot_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]+mature_shoot_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]-mature_shoot_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, mature_shoot_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]+mature_shoot_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]-mature_shoot_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, mature_shoot_total, col=1:10, lwd=3, legend=F, ylab="Early season shoot growth (cm)", xlab="", las=1))
points(x=0.95, mature_shoot_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]+mature_shoot_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]-mature_shoot_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, mature_shoot_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]+mature_shoot_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]-mature_shoot_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, mature_shoot_total, col=1:10, lwd=3, legend=F, ylab="Mature shoot growth (cm)", xlab="", las=1))
# add summary points and error bars
points(x=0.95, mature_shoot_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]+mature_shoot_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=mature_shoot_exposure_means[1,2], x1=0.95, y1=mature_shoot_exposure_means[1,2]-mature_shoot_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, mature_shoot_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]+mature_shoot_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=mature_shoot_exposure_means[2,2], x1=2.05, y1=mature_shoot_exposure_means[2,2]-mature_shoot_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="'Sucker' shoot growth (cm)", xlab=""))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Basal shoot growth (cm)", xlab=""))
immature_shoot_treatment_means <- aggregate(immature_shoot_total ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
immature_shoot_exposure_means <- aggregate(immature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, mean)
immature_shoot_exposure_sd <- aggregate(immature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, sd)
immature_shoot_exposure_means$standard_error <- immature_shoot_exposure_sd$immature_shoot_total/sqrt(10)
immature_shoot_treatment_means <- aggregate(immature_shoot_total ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
immature_shoot_exposure_means <- aggregate(immature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, mean)
immature_shoot_exposure_sd <- aggregate(immature_shoot_total ~ Wind.Exposure, data=mature_shoot_treatment_means, sd)
immature_shoot_exposure_means$standard_error <- immature_shoot_exposure_sd$immature_shoot_total/sqrt(10)
immature_shoot_treatment_means <- aggregate(immature_shoot_total ~ Genotype * Wind.Exposure, data=Caloptilia_only, mean)
immature_shoot_exposure_means <- aggregate(immature_shoot_total ~ Wind.Exposure, data=immature_shoot_treatment_means, mean)
immature_shoot_exposure_sd <- aggregate(immature_shoot_total ~ Wind.Exposure, data=immature_shoot_treatment_means, sd)
immature_shoot_exposure_means$standard_error <- immature_shoot_exposure_sd$immature_shoot_total/sqrt(10)
points(x=0.95, immature_shoot_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=immature_shoot_exposure_means[1,2], x1=0.95, y1=immature_shoot_exposure_means[1,2]+immature_shoot_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=immature_shoot_exposure_means[1,2], x1=0.95, y1=immature_shoot_exposure_means[1,2]-immature_shoot_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, immature_shoot_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=immature_shoot_exposure_means[2,2], x1=2.05, y1=immature_shoot_exposure_means[2,2]+immature_shoot_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=immature_shoot_exposure_means[2,2], x1=2.05, y1=immature_shoot_exposure_means[2,2]-immature_shoot_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Basal shoot growth (cm)", xlab="", las=1))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Basal shoot growth (cm)", xlab="", las=1))
# add summary points and error bars
points(x=0.95, immature_shoot_exposure_means[1,2], pch=19)
arrows(x0=0.95, y0=immature_shoot_exposure_means[1,2], x1=0.95, y1=immature_shoot_exposure_means[1,2]+immature_shoot_exposure_means[1,3], angle=90, length=0.1)
arrows(x0=0.95, y0=immature_shoot_exposure_means[1,2], x1=0.95, y1=immature_shoot_exposure_means[1,2]-immature_shoot_exposure_means[1,3], angle=90, length=0.1)
points(x=2.05, immature_shoot_exposure_means[2,2], pch=19)
arrows(x0=2.05, y0=immature_shoot_exposure_means[2,2], x1=2.05, y1=immature_shoot_exposure_means[2,2]+immature_shoot_exposure_means[2,3], angle=90, length=0.1)
arrows(x0=2.05, y0=immature_shoot_exposure_means[2,2], x1=2.05, y1=immature_shoot_exposure_means[2,2]-immature_shoot_exposure_means[2,3], angle=90, length=0.1)
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Basal shoot growth (cm)", xlab="", las=1, cex=2))
with(Caloptilia_only, interaction.plot(Wind.Exposure, Genotype, immature_shoot_total, col=1:10, lwd=2, legend=F, ylab="Basal shoot growth (cm)", xlab="", las=1, cex.lab=2))
