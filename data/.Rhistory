K <- 10.0
e <- 0.8
m <- 0.5
Ro <- 1.0
Tau <- 2.7
R <- 0.6
Time <- 25
p.ssCR <- c(r = r, K = K, e = e, m = m, Ro = Ro, Tau = Tau)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
library(deSolve)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
r <- 0.6
K <- 10.0
e <- 0.8
m <- 0.5
Ro <- 1.0
Tau <- 2.7
a <- 1.0 # not mentioned in McCann's book
R <- 0.6
Time <- 25
p.ssCR <- c(r = r, K = K, e = e, m = m, Ro = Ro, Tau = Tau)
ssCR.1 <- ode(R, 1:Time, ssCR, p.ssCR)
ssCR.1
library('bipartite')
data(Safariland)
plotweb(Safariland)
visweb(Safariland)
visweb(Safariland, type = "diagonal")
nested(Safariland, method = "NODF")
nested(Safariland, method = "NODF2")
visweb(Safariland, type = "nested")
obs <- unlist(networklevel(Safariland, index="weighted nestedness"))
nulls <- nullmodel(Safariland, N=100, method=1)
null <- unlist(sapply(nulls, networklevel, index="weighted nestedness")) #takes a while ...
plot(density(null), xlim=c(min(obs, min(null)), max(obs, max(null))),
main="comparison of observed with null model Patefield")
abline(v=obs, col="red", lwd=2)
networklevel(Safariland, index="weighted nestedness")
networklevel(Safariland, index="NODF2")
networklevel(Safariland, index="NODF")
networklevel(Safariland, index="nestedness")
data(memott1999)
data(memmott1999)
nested(memmott1999, index="NODF2")
nested(memmott1999, type="NODF2")
nested(memmott1999, method="NODF2")
nested(memmott1999, method="weighted nestedness")
nested(memmott1999, method=6)
nested(memmott1999, method="weighted NODF")
nested(memmott1999, method="NODF")
nested(memmott1999, method="NODF2")
data(mosquin1967)
visweb(mosquin1967)
nested(mosquin1967, method="weighted NODF")
nested(mosquin1967, method="NODF2")
null.mosquin <- nullmodel(mosquin1967, N=100, method = "r2d")
plot(null.mosquin)
null.mosquin
## Not run:
data(Safariland)
nullmodel(Safariland, N=2, method=1)
nullmodel(Safariland>0, N=2, method=4)
# analysis example:
obs <- unlist(networklevel(Safariland, index="weighted nestedness"))
nulls <- nullmodel(Safariland, N=100, method=1)
null <- unlist(sapply(nulls, networklevel, index="weighted nestedness")) #takes a while ...
plot(density(null), xlim=c(min(obs, min(null)), max(obs, max(null))),
main="comparison of observed with null model Patefield")
abline(v=obs, col="red", lwd=2)
praw <- sum(null>obs) / length(null)
ifelse(praw > 0.5, 1-praw, praw)
praw
## Not run:
data(Safariland)
nullmodel(mosquin1967, N=2, method=1)
nullmodel(mosquin1967>0, N=2, method=4)
# analysis example:
obs <- unlist(networklevel(mosquin1967, index="weighted nestedness"))
nulls <- nullmodel(mosquin1967, N=100, method=1)
null <- unlist(sapply(nulls, networklevel, index="weighted nestedness")) #takes a while ...
plot(density(null), xlim=c(min(obs, min(null)), max(obs, max(null))),
main="comparison of observed with null model Patefield")
abline(v=obs, col="red", lwd=2)
praw <- sum(null>obs) / length(null)
ifelse(praw > 0.5, 1-praw, praw)
praw
## Not run:
data(Safariland)
nullmodel(mosquin1967, N=2, method=1)
nullmodel(mosquin1967>0, N=2, method=4)
# analysis example:
obs <- unlist(networklevel(mosquin1967, index="NODF"))
nulls <- nullmodel(mosquin1967, N=100, method=1)
null <- unlist(sapply(nulls, networklevel, index="NODF")) #takes a while ...
plot(density(null), xlim=c(min(obs, min(null)), max(obs, max(null))),
main="comparison of observed with null model Patefield")
abline(v=obs, col="red", lwd=2)
praw <- sum(null>obs) / length(null)
ifelse(praw > 0.5, 1-praw, praw)
plotweb(mosquin1967)
plotweb(mosquin1967)
compart(mosquin1967)
visweb(mosquin1967, type="diagonal")
library("cheddar", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
Degree(SkipwithPond)
data(SkipwithPond)
Degree(SkipwithPond)
plot(SkipwithPond)
library('bipartite')
data(small1976)
str(small1976)
small1976
plotweb(small1976)
visweb(small1976)
visweb(small1976, type="diagonal")
module <- computeModules(small1976)
plotModuleWeb(module)
nested(small1976, method="NODF2")
nested(small1976, method="weidghted NODF")
nested(small1976, method= 6)
nested(small1976, method= "weighted NODF")
nestedness(small1976, null.models=T, n.nulls=100)
networklevel(small1976, index="ALL")
library(cheddar)
data(SkipwithPond)
SkipwithPond
str(SkipwithPond)
plot(SkipwithPond)
library(knitr)
library(knitcitations)
library(vegan)
library("mvabund", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
data(spider)
spiddat <- mvabund(spider$abund)
X <- spider$x
best.r.sq( spiddat~X)
head(spiddat)
library(knitr)
library(knitcitations)
bibliography
bibliography()
bibliography(proposal_bib)
proposal_bib <- read.bibtex("~/Documents/BibTex/PhD Proposal.bib")
bibliography(proposal_bib)
bibliography()
citep(proposal_bib)
proposal_bib[1]
proposal_bib[2]
library(knitr)
library(knitcitations)
proposal_bib[[1]]
proposal_bib <- read.bibtex("~/Documents/BibTex/PhD Proposal.bib")
proposal_bib[1]
proposal_bib
leafWt <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf Weight - Collected and Wet - Willow Garden 2012.csv")
leafWt
leafWt.noDoubles <- leafWt[-c(28, 44, 54), ] # remove doubles
leafWt <- subset(leafWt.noDoubles, select = c("Plant.Position", "Collection.Leaf.Weight", "Wet.Leaf.Weight"))
leafDryWt <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf Weight - Dry - Willow Garden 2012.csv")
leafDryWt.noDoubles <- leafDryWt[-c(3, 5, 17), ] # remove doubles
leafDryWt <- subset(leafDryWt.noDoubles, select=c("Plant.Position","Dry.Leaf.Weight"))
Leaf_Measurements_Willow_Garden_2012 <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf_Measurements_Willow_Garden_2012.csv")
viewData(Leaf_Measurements_Willow_Garden_2012)
leafArea <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf_Measurements_Willow_Garden_2012.csv", skip=2)
head(leafArea)
duplicated(leafArea$Plant.Position)
leafArea$Plant.Position
leafArea$Plant.Position[c(96,95),]
leafArea$Plant.Position[c(96,95),2]
leafArea$Plant.Position[c(96,95)]
match(leafArea$Plant.Position, 62)
leafArea$Plant.Position[60]
match(leafArea$Plant.Position, c(346,249))
leafArea.noDoubles <- leafArea[-c(60, 96, 95)] # removes leaves that were torn and uses the second replicates taken for them.
leafDryWt <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf Weight - Dry - Willow Garden 2012.csv")
leafDryWt
leafDryWt <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Leaf Weight - Dry - Willow Garden 2012.csv")
duplicated(leafDryWt$Plant.Position)
leafDryWt$Plant.Position[c(69,60,106)]
leafDryWt$Plant.Position[c(69,70,106)]
leafDryWt.noDoubles <- leafDryWt[-c(69, 70, 106), ] # remove doubles
leafDryWt <- subset(leafDryWt.noDoubles, select=c("Plant.Position","Dry.Leaf.Weight"))
trichome_data <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Willow Garden - Leaf Trichome Densities - 2012.csv")
duplicated(trichome_data$Plant.Position)
trichome_data$Plant.Position[c(56,64,81)]
trichome_data_noDoubles <- trichomes[-c(56,64,81), ] # decided to just remove first sample of plant positions 62, 249, and 346.  I don't think it is important to match the leaf weight of the other samples, because these measurements are unrelated.
trichome_data_noDoubles <- trichome_data[-c(56,64,81), ] # decided to just remove first sample of plant positions 62, 249, and 346.  I don't think it is important to match the leaf weight of the other samples, because these measurements are unrelated.
trichome_data <- subset(trichome_data_noDoubles, select=c("Plant.Position", "Trichome.No."))
condensed_tannins_2012_ready_for_R <- read.csv("~/Documents/Genotype_Willow_Community/datasets/condensed_tannins_2012_ready_for_R.csv")
viewData(condensed_tannins_2012_ready_for_R)
tannin_chemistry <- condensed_tannins_2012_ready_for_R <- read.csv("~/Documents/Genotype_Willow_Community/datasets/condensed_tannins_2012_ready_for_R.csv", skip =1) # condensed tannins measured in mg/gm.
head(tannin_chemistry)
duplicate(tannin_chemistry$Plant.Position)
duplicated(tannin_chemistry$Plant.Position)
tannin_chemistry[c(7, 38, 62)]
tannin_chemistry[c(7, 38, 62),]
match(tannin_chemistry$Plant.Position, c(62,249,346))
tannin_chemistry[c(6,7, 37,38, 61,62),]
tannin_chemistry <- condensed_tannins_2012_ready_for_R <- read.csv("~/Documents/Genotype_Willow_Community/datasets/condensed_tannins_2012_ready_for_R.csv", skip =1) # condensed tannins measured in mg/gm.
duplicated(tannin_chemistry$Plant.Position)
tannin_chemistry[c(6,7, 37,38, 61,62),] # don't know which of these samples were damaged.  If they don't influence the analysis, I'll just use the first measure in the datasheet.
plot(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype)
tannin_lm <- lm(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype)
summary(tannin_lm)
plot(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(7,38,62)])
tannin_lm <- lm(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(7,38,62)])
summary(tannin_lm)
plot(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(6,37,61)])
tannin_lm <- lm(tannin_chemistry$Soluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(6,37,61)])
summary(tannin_lm)
tannin_chemistry[c(6,7, 37,38, 61,62),] # don't know which of these samples were damaged.  If they don't influence the analysis, I'll just use the first measure in the datasheet.
plot(tannin_chemistry$Insoluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(6,37,61)])
tannin_lm <- lm(tannin_chemistry$Insoluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(6,37,61)])
summary(tannin_lm)
plot(tannin_chemistry$Insoluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(7,38,62)])
tannin_lm <- lm(tannin_chemistry$Insoluble.condensed.tannins ~ tannin_chemistry$Genotype, data=tannin_chemistry[-c(7,38,62)])
summary(tannin_lm)
tannin_chemistry[-c(7,38,62)]
tannin_chemistry <- tannin_chemistry[-c(6,37,61)]
leaf_chemistry <- read.csv("~/Documents/Genotype_Willow_Community/datasets/willow_garden_leaf_chemistry_summer_2012_Results_2013_transposed.csv", skip=1) # Phenolic Glycoside data
head(leaf_chemistry)
duplicated(leaf_chemistry$Plant.Position)
leaf_C_N_data <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Willow 2010 CHNsamples copy.csv")
leaf_C_N_data$C_N_ratio <- leaf_C_N_data$Carbon / leaf_C_N_data$Nitrogen
leaf_C_N_data <- leaf_C_N_data[1:140, ]
duplicated(leaf_C_N_data$Plant..)
duplicated(leaf_C_N_data)
duplicated(leaf_C_N_data$Plant..)
leaf_C_N_data <- leaf_C_N_data[-c(14, 35, 57, 99, 118)] # just removed ones labeled as duplicates (second samples) for convenience
leaf_C_N_data$C_N_ratio <- leaf_C_N_data$Carbon / leaf_C_N_data$Nitrogen
dim(leaf_C_N_data)
leaf_C_N_data$Plant..
head(leaf_C_N_data)
leaf_C_N_data$Plant.Position <- leaf_C_N_data$Plant..
head(leaf_C_N_data)
leaf_C_N_data <- subset(leaf_C_N_data, select=c("Plant.Position", "Genotype", "Nitrogen", "Carbon", "C_N_ratio"))
architecture_data <- read.csv("~/Documents/Genotype_Willow_Community/datasets/Architect_prelims.csv")
head(architecture_data)
architecture_data
architecture_data$Plant.Position <- architecture_data$plant.position
architecture_data$Genotype <- architecture_data$genotype
match(architecture_data$X.Area, "NaN")
architecture_data[c(34, 77, 78, 87, 89, 121, 120, 119, 117)]
architecture_data[c(34, 77, 78, 87, 89, 121, 120, 119, 117),]
library("xtable", lib.loc="/Library/Frameworks/R.framework/Versions/2.15/Resources/library")
## Load example dataset
data(tli)
## Demonstrate data.frame
tli.table <- xtable(tli[1:20,])
digits(tli.table)[c(2,6)] <- 0
print(tli.table)
print(tli.table,type="html")
Wind_Arthropod_data_survey_1_May_10_2013 <- read.csv("~/Documents/Lanphere_Experiments/data/Wind_Arthropod_data_survey_1_May_10_2013.csv")
viewData(Wind_Arthropod_data_survey_1_May_10_2013)
wind_arthropods_May_11_2013 <- read.csv("~/Documents/Lanphere_Experiments/data/Wind_Arthropod_data_survey_1_May_10_2013.csv", skip=4)
head(wind_arthropods_May_11_2013)
wind_arthropods_May_11_2013 <- read.csv("~/Documents/Lanphere_Experiments/data/Wind_Arthropod_data_survey_1_May_10_2013.csv", skip=4)
head(wind_arthropods_May_11_2013)
str(wind_arthropods_May_11_2013)
wind_arthropods_May_11_2013$Block <- as.factor(wind_arthropods_May_11_2013$Block)
str(wind_arthropods_May_11_2013)
library(ggplot2)
install.packages("BiodiversityR")
library(BiodiversityR)
wind_arthropods_May_11_2013_subset <- subset(wind_arthropods_May_11_2013, select=-c(Calop_pre_tentmine, Leaf_bundle, Calop_LTF, Calop_cocoon, miscellaneous_arthropods_present_see_notes, Notes)) # remove Calop_pre_tentmine because of its difficulty in reliably sampling.  Also remove leaf_bundle temporarily because I don't know yet how I want to treat the "old" mines.  Also, remove Calop_LTF because I think the same larva may be responsible for multiple leaf folds on tiny, crappy looking plants.  Also remove Calop_cocoon for now although it may yield important information on survival.  Also remove miscellaneous arthropods and notes
which(wind_arthropods_May_11_2013_subset$Dead == 1)
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[-which(wind_arthropods_May_11_2013_subset$Dead == 1), ]
dim(wind_arthropods_May_11_2013_subset)
str(wind_arthropods_May_11_2013_subset)
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[-which(wind_arthropods_May_11_2013_subset$Dead == 1),-21 ] # remove all plants labelled as dead
dim(wind_arthropods_May_11_2013_subset)
wind_arthropods_May_11_2013_subset
wind_arthropods_May_11_2013 <- read.csv("~/Documents/Lanphere_Experiments/data/Wind_Arthropod_data_survey_1_May_10_2013.csv", skip=4)
str(wind_arthropods_May_11_2013)
wind_arthropods_May_11_2013$Block <- as.factor(wind_arthropods_May_11_2013$Block)
wind_arthropods_May_11_2013_subset <- subset(wind_arthropods_May_11_2013, select=-c(Calop_pre_tentmine, Leaf_bundle, Calop_LTF, Calop_cocoon, miscellaneous_arthropods_present_see_notes, Notes)) # remove Calop_pre_tentmine because of its difficulty in reliably sampling.  Also remove leaf_bundle temporarily because I don't know yet how I want to treat the "old" mines.  Also, remove Calop_LTF because I think the same larva may be responsible for multiple leaf folds on tiny, crappy looking plants.  Also remove Calop_cocoon for now although it may yield important information on survival.  Also remove miscellaneous arthropods and notes
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[-which(wind_arthropods_May_11_2013_subset$Dead == 1), ] # remove
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[ ,-21]
str(wind_arthropods_May_11_2013_subset)
wind_arthropods_May_11_2013_subset$arthropod_abundance <- rowSums(wind_arthropods_May_11_2013_subset[ ,5:20])
wind_arthropods_May_11_2013_subset$arthropod_richness <- specnumber(wind_arthropods_May_11_2013_subset[ ,5:20])
with(wind_arthropods_May_11_2013_subset, table(Genotype,arthropod_abundance))
with(wind_arthropods_May_11_2013_subset, table(Genotype,Wind.Exposure))
with(wind_arthropods_May_11_2013_subset, table(Wind.Exposure, arthropod_abundance))
qplot(arthropod_abundance ~ Genotype, data=wind_arthropods_May_11_2013_subset)
qplot(arthropod_abundance, Genotype, data=wind_arthropods_May_11_2013_subset)
abundance <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Genotype, y=arthropod_abundance))
abundance + geom_boxplot()
abundance <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Wind.Exposure, y=arthropod_abundance))
abundance + geom_boxplot()
abundance <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Wind.Exposure, y=arthropod_abundance, color=Genotype))
abundance + geom_boxplot() # unexposed plots appear to have higher abundances
richness <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Wind.Exposure, y=arthropod_richness, color=Genotype))
richness + geom_boxplot()
qplot(wind_arthropods_May_11_2013_subset$arthropod_abundance, geom=histogram)
qplot(wind_arthropods_May_11_2013_subset$arthropod_abundance)
qplot(wind_arthropods_May_11_2013_subset$arthropod_richness)
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,supp), summarise, val=mean(arthropod_abundance))
install.packages("plyr")
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,supp), summarise, val=mean(arthropod_abundance))
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=mean(arthropod_abundance))
abundance_means
abundance + geom_boxplot() + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype))
abundance + geom_boxplot() + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype))
library(ggplot2)
library(BiodiversityR)
library(plyr)
abundance + geom_boxplot() + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype))
abundance + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype))
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=median(arthropod_abundance))
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=mean(arthropod_abundance))
abundance_medians <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=median(arthropod_abundance))
abundance + geom_point(data=abundance_medians, aes(y=val)) + geom_line(data=abundance_medians, aes(y=val, group=Genotype)) # I think these two outlying points are driving by some outlying abundances for the "mean" data.
abundance + geom_boxplot() # unexposed plots appear to have higher abundances
which(wind_arthropods_May_11_2013_subset$arthropod_abundance > 10)
wind_arthropods_May_11_2013_subset[8, ]
which(wind_arthropods_May_11_2013_subset$Genotype == G)
which(wind_arthropods_May_11_2013_subset$Genotype == "G")
wind_arthropods_May_11_2013_subset[which(wind_arthropods_May_11_2013_subset$Genotype == "G"), ]
abundance + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_medians, aes(y=val, group=Genotype)) # One of the outlying datapoints comes from the 8 Calop_tent_mines with the 4 leaf_bumps. The second outlying data point came from the same plot with also a very high Calop_tent_mine count (6).
abundance + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype)) # One of the outlying datapoints comes from the 8 Calop_tent_mines with the 4 leaf_bumps. The second outlying data point came from the same plot with also a very high Calop_tent_mine count (6).
abundance + boxplot() + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype)) # One of the outlying datapoints comes from the 8 Calop_tent_mines with the 4 leaf_bumps. The second outlying data point came from the same plot with also a very high Calop_tent_mine count (6).
abundance + geom_boxplot() + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype)) # One of the outlying datapoints comes from the 8 Calop_tent_mines with the 4 leaf_bumps. The second outlying data point came from the same plot with also a very high Calop_tent_mine count (6).
abundance + geom_boxplot() # unexposed plots appear to have higher abundances, a couple of outlying datapoints though.
richness_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=mean(arthropod_richness))
richness + geom_boxplot() # same pattern as abundance
richness + geom_point(data=richness_means, aes(y=val)) + geom_line(data=richness_means, aes(y=val, group=Genotype))
aov_richness <- aov(arthropod_richness ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= wind_arthropods_May_11_2013_subset, qr=TRUE)
aov_richness
summary(aov_richness)
with(wind_arthropods_May_11_2013_subset, table(Genotype, Wind.Exposure))
library(lmer)
install.packages("lmer")
install.packages("lme4")
library("lme4", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
lmer_richness <- lmer(arthropod_richness ~ Genotype * Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
summary(lmer_richness)
lmer_richness_full <- lmer(arthropod_richness ~ Genotype * Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_null <- lmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype <- lmer(arthropod_richness ~ Genotype + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_exposure <- lmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype_exposure <- lmer(arthropod_richness ~ Genotype + Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_full <- lmer(arthropod_richness ~ Genotype * Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
anova(lmer_richness_null, lmer_richness_genotype)
anova(lmer_richness_null, lmer_richness_exposure)
anova(lmer_richness_exposure, lmer_richness_genotype_exposure)
anova(lmer_richness_exposure, lmer_richness_full)
anova(lmer_richness_exposure, lmer_richness_genotype_exposure, lmer_richness_full)
anova(lmer_richness_null, lmer_richness_exposure) # SUGGESTS A SIGNIFICANT EFFECT OF WIND EXPOSURE.
anova(lmer_richness_null, lmer_richness_genotype) # suggests no signficant effect of Genotype
anova(lmer_richness_null, lmer_richness_exposure) # SUGGESTS A SIGNIFICANT EFFECT OF WIND EXPOSURE.
richness + geom_point(data=richness_means, aes(y=val)) + geom_line(data=richness_means, aes(y=val, group=Genotype)) # suggests an interactive effect of plant genotype on arthropod richness
lmer_richness_null <- lmer(log(arthropod_richness+1) ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_exposure <- lmer(log(arthropod_richness+1) ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
anova(lmer_richness_null, lmer_richness_exposure) # SUGGESTS A SIGNIFICANT EFFECT OF WIND EXPOSURE.
plot(lmer_richness_exposure)
qplot(log(wind_arthropods_May_11_2013_subset$arthropod_richness+1))
glmer_richness_null <- glmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
glmer_richness_exposure <- glmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
anova(glmer_richness_null, glmer_richness_exposure)
glmer_richness_genotype <- glmer(arthropod_richness ~ Genotype + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
anova(glmer_richness_null, glmer_richness_genotype) #glmer_richness_exposure)
summary(glmer_richness_exposure)
###### upload required libraries
library(ggplot2)
library(BiodiversityR)
library(plyr)
library(lmer)
###### upload and manage the data the data
wind_arthropods_May_11_2013 <- read.csv("~/Documents/Lanphere_Experiments/data/Wind_Arthropod_data_survey_1_May_10_2013.csv", skip=4)
str(wind_arthropods_May_11_2013)
wind_arthropods_May_11_2013$Block <- as.factor(wind_arthropods_May_11_2013$Block)
wind_arthropods_May_11_2013_subset <- subset(wind_arthropods_May_11_2013, select=-c(Calop_pre_tentmine, Leaf_bundle, Calop_LTF, Calop_cocoon, miscellaneous_arthropods_present_see_notes, Notes)) # remove Calop_pre_tentmine because of its difficulty in reliably sampling.  Also remove leaf_bundle temporarily because I don't know yet how I want to treat the "old" mines.  Also, remove Calop_LTF because I think the same larva may be responsible for multiple leaf folds on tiny, crappy looking plants.  Also remove Calop_cocoon for now although it may yield important information on survival.  Also remove miscellaneous arthropods and notes
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[-which(wind_arthropods_May_11_2013_subset$Dead == 1), ] # remove all plants labelled as dead
wind_arthropods_May_11_2013_subset <- wind_arthropods_May_11_2013_subset[ ,-21]
###### Exploratory data analysis
# how many plants in each treatment
with(wind_arthropods_May_11_2013_subset, table(Genotype, Wind.Exposure)) # Genotypes G and S are creating an unbalanced data set and seem particularly susceptible to wind exposure.
# create arthropod abundance and richness variables
wind_arthropods_May_11_2013_subset$arthropod_abundance <- rowSums(wind_arthropods_May_11_2013_subset[ ,5:20])
wind_arthropods_May_11_2013_subset$arthropod_richness <- specnumber(wind_arthropods_May_11_2013_subset[ ,5:20])
# ggplot graphs
abundance <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Wind.Exposure, y=arthropod_abundance, color=Genotype))
abundance + geom_boxplot() # unexposed plots appear to have higher abundances, a couple of outlying datapoints though.
richness <- ggplot(wind_arthropods_May_11_2013_subset, aes(x=Wind.Exposure, y=arthropod_richness, color=Genotype))
richness + geom_boxplot() # same pattern as abundance
qplot(wind_arthropods_May_11_2013_subset$arthropod_abundance) # highly right skewed distributions
qplot(wind_arthropods_May_11_2013_subset$arthropod_richness) # highly right skewed distributions
abundance_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=mean(arthropod_abundance))
abundance_medians <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=median(arthropod_abundance)) # Not enough variation to detect a strong pattern
abundance + geom_point(data=abundance_means, aes(y=val)) + geom_line(data=abundance_means, aes(y=val, group=Genotype)) # One of the outlying datapoints comes from the 8 Calop_tent_mines with the 4 leaf_bumps. The second outlying data point came from the same plot with also a very high Calop_tent_mine count (6).
richness_means <- ddply(wind_arthropods_May_11_2013_subset, .(Wind.Exposure,Genotype), summarise, val=mean(arthropod_richness))
richness + geom_point(data=richness_means, aes(y=val)) + geom_line(data=richness_means, aes(y=val, group=Genotype)) # suggests a possible interactive effect of plant genotype on arthropod richness. However, the mixed effects model suggest that wind exposure dominates plant genotype.
### Model the data
# problem with the anova model is that mortality has created an imbalance in my data.
aov_richness <- aov(arthropod_richness ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= wind_arthropods_May_11_2013_subset, qr=TRUE)
summary(aov_richness)
# use linear mixed effects model. Create nested models and fit with likelihood ration test. Code taken from presentation at: http://www.stat.wisc.edu/courses/st572-larget/Spring2007/handouts16-4.pdf
lmer_richness_null <- lmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype <- lmer(arthropod_richness ~ Genotype + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_exposure <- lmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype_exposure <- lmer(arthropod_richness ~ Genotype + Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_full <- lmer(arthropod_richness ~ Genotype * Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
anova(lmer_richness_null, lmer_richness_genotype) # suggests no signficant effect of Genotype
anova(lmer_richness_null, lmer_richness_exposure) # SUGGESTS A SIGNIFICANT EFFECT OF WIND EXPOSURE.
anova(lmer_richness_exposure, lmer_richness_genotype_exposure) # adding Genotype as a main effect doesn't improve model fit
anova(lmer_richness_exposure, lmer_richness_genotype_exposure, lmer_richness_full) # adding genotype as main effect or its interaction doesn't improve model fit.
# Linear mixed effects model suggests that wind exposure dominates the effects of plant genotype on arthropod richness. This effect is persistent with log transformed richness data.  Now lets try and fit a genearlized mixed effects model
glmer_richness_null <- glmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
glmer_richness_exposure <- glmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
anova(glmer_richness_null, glmer_richness_exposure)
library(lme4)
lmer_richness_null <- lmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype <- lmer(arthropod_richness ~ Genotype + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_exposure <- lmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_genotype_exposure <- lmer(arthropod_richness ~ Genotype + Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
lmer_richness_full <- lmer(arthropod_richness ~ Genotype * Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset)
anova(lmer_richness_null, lmer_richness_genotype) # suggests no signficant effect of Genotype
anova(lmer_richness_null, lmer_richness_exposure) # SUGGESTS A SIGNIFICANT EFFECT OF WIND EXPOSURE.
anova(lmer_richness_exposure, lmer_richness_genotype_exposure) # adding Genotype as a main effect doesn't improve model fit
anova(lmer_richness_exposure, lmer_richness_genotype_exposure, lmer_richness_full) # adding genotype as main effect or its interaction doesn't improve model fit.
# Linear mixed effects model suggests that wind exposure dominates the effects of plant genotype on arthropod richness. This effect is persistent with log transformed richness data.  Now lets try and fit a genearlized mixed effects model
glmer_richness_null <- glmer(arthropod_richness ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
glmer_richness_exposure <- glmer(arthropod_richness ~ Wind.Exposure + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
anova(glmer_richness_null, glmer_richness_exposure)
# The Generalized mixed effects model assuming a poisson distribution shows even stronger support for a wind effect.
richness + geom_point(data=richness_means, aes(y=val)) + geom_line(data=richness_means, aes(y=val, group=Genotype)) # suggests a possible interactive effect of plant genotype on arthropod richness. However, the mixed effects model suggest that wind exposure dominates plant genotype.
#### This script analyzes arthropod data collected from my wind experiment
# set working directory and load required libraries
setwd("~/Documents/Lanphere_Experiments/data")
library("vegan")
library("BiodiversityR")
library("mvabund")
library("MASS")
library("bipartite")
# source in managed data sets
source('wind_manage_arthropod_dissection_data.R')
source('wind_manage_visual_arthropod_surveys.R')
source('wind_manage_plant_trait_data.R')
###### Merge and manage data sets
# merge all of the arthropod and plant info data together
all_arthropods <- merge(arthropod_wind_visual_data_2012, compact_wind_miners, by.x = "plant_code", by.y = "ID_plant_miners", all.x=TRUE)
all_arthropods <- merge(all_arthropods, compact_wind_ties, by.x = "plant_code", by.y = "ID_plant_ties", all.x = TRUE)
# change all of the NA's in the columns to zeros.  These actually reflect real zeros but the reason for the NA's is because of an artifact from merging the data sets together
all_arthropods[ ,7:31][is.na(all_arthropods[ ,7:31])] <- 0
# focus on herbivore columns. Includes "ALL" instead of just living Caloptilia and tortricids
all_herbivore_data_frame <- with(all_arthropods, cbind.data.frame(leaf_hoppers_blue_brown, Leaf.Hoppers.Camo, Light.Green.Aphids, stem_gall, volcano_gall, mite_gall, yellow_knife_leaf_hopper, twisty_gall, giant_willow_aphid, psyllidae, sawflies, LH.nymph.other, aphid_species_used_in_ant_aphid_experiment, all_Caloptilia, all_tortricid))
all_arthropods$herbivore_rich <- specnumber(all_herbivore_data_frame)
all_arthropods$herbivore_abund <- rowSums(all_herbivore_data_frame)
# focus on predator/parasitoid columns
all_predator_data_frame <- with(all_arthropods, cbind.data.frame(Black.Ants,Red.ants,Spiders.black.with.yellow.legs, Spiders.Other, sp_327_LT.1, LTF_329, LEF_eulophid_cocoons, sp_323_all))
all_arthropods$enemy_rich <- specnumber(all_predator_data_frame)
all_arthropods$enemy_abund <- rowSums(all_predator_data_frame)
# arthropod richness and abundance in general
all_arthropods$all_rich <- all_arthropods$herbivore_rich + all_arthropods$enemy_rich
all_arthropods$all_abund <- all_arthropods$herbivore_abund + all_arthropods$enemy_abund
# predator/prey richness. added one to all values to deal with instances of zero species for herbivores.
all_arthropods$predator_prey_richness_ratio <- (all_arthropods$enemy_rich+1)/(all_arthropods$herbivore_rich + 1)
# all arthropods but no dead plants included.  Weird, but it is screwing up my ANOVA analysis, so right now I'm not comfortable using it.
no_dead_all_arthropods <- subset(all_arthropods, Dead. == 0)
########## Exploratory Plots
# richness
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, herbivore_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, enemy_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_rich, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, predator_prey_richness_ratio, col=1:10, lwd=2))
# abundance
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, herbivore_abund, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, enemy_abund, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_abund, col=1:10, lwd=2))
# species specific abundances
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_Caloptilia, col=1:10, lwd=2))
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, Light.Green.Aphids, col=1:10, lwd=2))
# multivariate abundances, note that the order is reversed along the y-axis (don't know why). Also, doesn't currently account for dead plants.
#herb_mvabund <- mvabund(all_herbivore_data_frame)
#boxplot(herb_mvabund)
#pred_mvabund <- mvabund(all_predator_data_frame)
#boxplot(pred_mvabund)
########## Data analysis. log and sqrt transformations aren't working with the data...DON'T FORGET THAT QUANTIFYING LINKS AND NETWORK SIZE, ETC. MAY BE A WAY TO EXTRACT MORE INFORMATION FROM SIMPLY RICHNESS OF DIFFERENT TROPHIC LEVELS.
# richness data
aov_herb_rich <- aov(log(herbivore_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_herb_rich)
aov_enemy_rich <- aov(log(enemy_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_enemy_rich)
aov_all_rich <- aov(log(all_rich+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_all_rich)
aov_predator_prey_rich_ratio <- aov(log(predator_prey_richness_ratio + 1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_predator_prey_rich_ratio)
# abundance data
aov_herb_abund <- aov(log(herbivore_abund+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_herb_abund)
aov_enemy_abund <- aov(log(enemy_abund +1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_enemy_abund)
aov_all_abund <- aov(log(all_abund + 1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_all_abund)
aov_Caloptilia_abund <- aov(log(all_Caloptilia+1) ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_Caloptilia_abund)
aov_Light.Green.Aphid_abund <- aov(Light.Green.Aphids ~ Genotype * Wind.Exposure + Error(as.factor(Block)/Wind.Exposure), data= all_arthropods, qr=TRUE)
summary(aov_Light.Green.Aphid_abund)
library("lme4")
glmer_all_rich_null <- glmer(all_rich ~ 1 + (1 | Wind.Exposure:Block), data=wind_arthropods_May_11_2013_subset, family=poisson)
glmer_all_rich_null <- glmer(all_rich ~ 1 + (1 | Wind.Exposure:Block), data=all_arthropods, family=poisson)
str(all_arthropods)
glmer_all_rich_null <- glmer(all_rich ~ 1 + (1 | Wind.Exposure:as.factor(Block)), data=all_arthropods, family=poisson)
all_arthropods$block <- as.factor(all_arthropods$Block)
glmer_all_rich_null <- glmer(all_rich ~ 1 + (1 | Wind.Exposure:block), data=all_arthropods, family=poisson)
glmer_all_rich_exposure <- glmer(all_rich ~ Wind.Exposure + (1 | Wind.Exposure:block), data=all_arthropods, family=poisson)
anova(glmer_all_rich_null, glmer_all_rich_exposure)
glmer_all_rich_genotype <- glmer(all_rich ~ Genotype + (1 | Wind.Exposure:block), data=all_arthropods, family=poisson)
anova(glmer_all_rich_null, glmer_all_rich_genotype)
with(all_arthropods, interaction.plot(Wind.Exposure, Genotype, all_rich, col=1:10, lwd=2))
