setwd("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/")
Lanphere_Wind_run_1_results_CN <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv")
View(Lanphere_Wind_run_1_results_CN)
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv")
batch2 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_2_results_CN.csv")
Lanphere_Wind_run_2_results_CN <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_2_results_CN.csv")
View(Lanphere_Wind_run_2_results_CN)
batch2
Lanphere_Wind_run_3_results_CN <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv")
View(Lanphere_Wind_run_3_results_CN)
batch3 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv")
Lanphere_wind_run_4_results_CN <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv")
View(Lanphere_wind_run_4_results_CN)
batch4 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv")
Lanphere_wind_run_7_results_CN <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_7_results_CN.csv")
View(Lanphere_wind_run_7_results_CN)
batch7 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_7_results_CN.csv")
batch1
str(batch1)
str(batch2)
str(batch3)
str(batch4)
str(batch7)
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv", stringsAsFactors = FALSE)
str(batch1)
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv", stringsAsFactors = FALSE)
batch2 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_2_results_CN.csv", stringsAsFactors = FALSE) # unknown why there is a warning error, loaded data looks okay
batch3 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv", stringsAsFactors = FALSE)
batch4 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv", stringsAsFactors = FALSE)
batch7 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_7_results_CN.csv", stringsAsFactors = FALSE)
str(batch4)
str(batch3)
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7)
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv", stringsAsFactors = FALSE)
batch1
colnames(batch1) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch2
colnames(batch2) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch3
colnames(batch3) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent","possible.switch","notes")
colnames(batch4) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch4
batch7
colnames(batch1) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
colnames(batch7) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch1
batch1 <- batch1[-1, ] # remove first line which has no data
batch1
batch2
batch2 <- batch2[-1, ]
batch2
batch3
batch3 <- batch3[-1, ]
batch3
batch4
batch1
setwd("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/")
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch1) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch1 <- batch1[-1, ] # remove first line which has no data
batch1
batch2 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_2_results_CN.csv", stringsAsFactors = FALSE) # unknown why there is a warning error, loaded data looks okay
colnames(batch2) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch2 <- batch2[-1, ]
batch2
batch2$sample.id[2:3] <- c("6E1","2E5")
batch2
batch3 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch3) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent","possible.switch","notes")
batch3 <- batch3[-1, ]
batch3
batch4 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch4) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch4$sample.id
batch4$sample.id[c(5,8,11,14,17,19,20,23,25,27,30,31,32)]
batch4$sample.id[c(5,8,11,14,17,19,20,23,25,27,30,31,32)] <- c("1E4","1E9","7E1","2E2","5E1","4E8","3E3","5E5","1E10","3E8","7E3","2E9","6E6") # changed them to their appropriate ID
batch7
batch7 <- batch7[-1:42, ]
batch7 <- batch7[-c(1:42), ]
batch7
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7)
combined
dim(combined)
library(reshape2)
colsplit(combined$sample.id, c("E","U"), c("block","position"))
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
which(combined$sample.id == "blind standard")
which(combined$sample.id == "blind standard")
str(combined)
combined$sample.id
combind[combind %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
combined[combind %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
combined[combined %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
combined[combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
combined$sample.id[combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
combined$sample.id[!combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")]
which(combined$sample.id[!combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")])
which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1"))
row.remove <- which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1"))
combined <- combined[-row.remove, ]
combined
strsplit(combined$sample.id, [EU])
strsplit(combined$sample.id, "[EU]")
colsplit(combined$sample.id, "[EU]")
colsplit(combined$sample.id, "[EU]", c("block","position"))
colsplit
grep(combined$sample.id, "[EU]")
grep( "[EU]", combined$sample.id)
grepl("[EU]", combined$sample.id)
regmatches(combined$sample.id, "[EU]")
match(combined$sample.id, "[EU]")
colsplit(combined$sample.id, "[:digits:]")
colsplit(combined$sample.id, "[:digits:]", "treatment")
colsplit(combined$sample.id, "[0:9]", "treatment")
colsplit(combined$sample.id, "[EU]", c("block","position"))
plant.info <- colsplit(combined$sample.id, "[EU]", c("block","position"))
combined <- cbind.data.frame(combined, plant.info)
combined
grepRaw("[EU]", combined$sample.id)
grep("[EU]", combined$sample.id)
grepl("[EU]", combined$sample.id)
replace(combined$sample.id, "[EU]", "[EU]")
exposed <- grep("E", combined$sample.id)
exposed
unexposed <- grep("U", combined$sample.id)
treatment <- combined$sample.id
treatment
exposed <- grep("E", treatment)
unexposed <- grep("U", treatment)
treatment[exposed] <- "E"
treatment[unexposed] <- "U"
combined <- cbind.data.frame(combined, plant.info, treatment) # recombine block and plant position data back into original dataframe
combined
source("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
wind_plant_info <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
wind_plant_info
# combine datasets together
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
row.remove <- which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")) # identify data from standards and bypasses
combined <- combined[-row.remove, ] # removes unecessary data from standards and bypasses
wind_plant_info <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
wind_CN_data <- merge(wind_plant_info, combined, by.x = "plant.id", by.y = "sample.id", all.y = TRUE) # retain all of C_N data
wind_CN_data
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
combined$C_N <- combined$C.weight.percent/combined$N.weight.percent
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
combined$C_N <- combined$C.weight.percent/combined$N.weight.percent
combined$C.weight.percent/combined$N.weight.percent
combined$C.weight.percent
str(combined)
class(combined[ ,5:10]) <- "numeric"
combined[ ,5:10] <- sapply(combined[ ,5:10], as.numeric)
str(combined)
combined$C_N <- combined$C.weight.percent/combined$N.weight.percent
combined$C_N
row.remove <- which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")) # identify data from standards and bypasses
combined <- combined[-row.remove, ] # removes unecessary data from standards and bypasses
wind_plant_info <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
##### Merge datasets
wind_CN_data <- merge(wind_plant_info, combined, by.x = "plant.id", by.y = "sample.id", all.y = TRUE) # retain all of C_N data
dim(wind_CN_data)
hist(wind_CN_data$C_N)
library(ggplot2)
library(GGally)
ggpairs(cbind(wind_CN_data$C.weight.percent, wind_CN_data$N.weight.percent, wind_CN_data$C_N))
ggpairs(wind_CN_data, columns = c(C.weight.percent, N.weight.percent, C_N))
ggpairs(wind_CN_data[ ,c("C.weight.percent", "N.weight.percent", "C_N")])
plot(C_N ~ genotype, wind_CN_data)
plot(C_N ~ treatment, wind_CN_data)
plot(C_N ~ block, wind_CN_data)
plot(C_N ~ as.factor(block), wind_CN_data)
plot(C_N ~ genotype, wind_CN_data)
with(wind_CN_data, table(genotype, treatment, block))
with(wind_CN_data, table(genotype, treatment))
ggplot(data = wind_CN_data, aes(x = "treatment", y = "C_N", group = "genotype")) + geom_line()
ggplot(data = wind_CN_data, aes(x = treatment, y = C_N, group = "genotype")) + geom_line()
ggplot(data = wind_CN_data, aes(x = treatment, y = C_N, group = genotype)) + geom_line()
ggplot(data = wind_CN_data, aes(x = treatment, y = C_N, group = genotype, color = genotype)) + geom_line()
source("~/Documents/miscellaneous_R/summarySE_function.R")
summarySE
summarySE(data = wind_CN_data, measurevar = "C_N", groupvars = c("treatment","genotype"))
with(wind_CN_data, table(genotype, treatment))
summarySE(data = wind_CN_data, measurevar = "C_N", groupvars = c("treatment","genotype"))
summarizeCN <- summarySE(data = wind_CN_data, measurevar = "C_N", groupvars = c("treatment","genotype"))
summarizeCN
ggplot(data = summarizeCN, aes(x = treatment, y = C_N, group = genotype, color = genotype)) + geom_line()
duplicated(wind_CN_data$plant.id)
which(duplicated(wind_CN_data$plant.id))
wind_CN_data$plant.id[which(duplicated(wind_CN_data$plant.id))]
batch3
batch3
batch3 <- batch3[-c(1,15,16), ] # also removed the ones that may have been possibly switched
batch3
batch3 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv", stringsAsFactors = FALSE)
batch3
batch3[-c(1,15,16), ]
batch3 <- batch3[-c(1,15,16), ] # also removed the ones that may have been possibly switched
batch3
batch4 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch4) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch4$sample.id[c(5,8,11,14,17,19,20,23,25,27,30,31,32)] <- c("1E4","1E9","7E1","2E2","5E1","4E8","3E3","5E5","1E10","3E8","7E3","2E9","6E6") # changed them to their appropriate ID
batch7 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_7_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch7) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch7 <- batch7[-c(1:42), ] # removed samples that were not part of the wind experiment
# combine datasets together
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
combined[ ,5:10] <- sapply(combined[ ,5:10], as.numeric) # convert necessary variables to numeric ones
combined$C_N <- combined$C.weight.percent/combined$N.weight.percent
row.remove <- which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")) # identify data from standards and bypasses
combined <- combined[-row.remove, ] # removes unecessary data from standards and bypasses
wind_plant_info <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
##### Merge datasets
wind_CN_data <- merge(wind_plant_info, combined, by.x = "plant.id", by.y = "sample.id", all.y = TRUE) # retain all of C_N data
dim(wind_CN_data)
duplicated(wind_CN_data$plant.id) # there are a few duplicates
which(duplicated(wind_CN_data$plant.id))
wind_CN_data$plant.id[which(duplicated(wind_CN_data$plant.id))]
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
# set working directory
setwd("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/")
######## Upload datasets and clean them up.
# need to evaluate whether there are duplicates in the dataset or not. especially because excel may have messed up some of the sample IDs
batch1 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_1_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch1) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch1 <- batch1[-1, ] # remove first line which has no data
batch2 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_2_results_CN.csv", stringsAsFactors = FALSE) # unknown why there is a warning error, loaded data looks okay
colnames(batch2) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch2 <- batch2[-1, ]
batch2$sample.id[2:3] <- c("6E1","2E5") # changed them to their appropriate ID
batch3 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_Wind_run_3_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch3) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent","possible.switch","notes")
batch3 <- batch3[-c(1,15,16), ] # also removed the ones that may have been possibly switched
batch4 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_4_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch4) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch4$sample.id[c(5,8,11,14,17,19,20,23,25,27,30,31,32)] <- c("1E4","1E9","7E1","2E2","5E1","4E8","3E3","5E5","1E10","3E8","7E3","2E9","6E6") # changed them to their appropriate ID
batch7 <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/C_N_data/Lanphere_wind_run_7_results_CN.csv", stringsAsFactors = FALSE)
colnames(batch7) <- c("sample.time","unknown.variable", "sample.id", "sample.amount.mg", "N.reten.time.min","N.weight.mg","N.weight.percent","C.reten.time.min","C.weight.mg","C.weight.percent")
batch7 <- batch7[-c(1:42), ] # removed samples that were not part of the wind experiment
# combine datasets together
combined <- rbind.data.frame(batch1, batch2, batch3[ ,1:10], batch4, batch7) # didn't include notes from batch3
combined[ ,5:10] <- sapply(combined[ ,5:10], as.numeric) # convert necessary variables to numeric ones
combined$C_N <- combined$C.weight.percent/combined$N.weight.percent
row.remove <- which(combined$sample.id %in% c("blind standard","blind std", "Blind Standard", "standard 1", "standard 2", "standard 3", "bypass", "std2", "std 3", "std1")) # identify data from standards and bypasses
combined <- combined[-row.remove, ] # removes unecessary data from standards and bypasses
wind_plant_info <- read.csv("~/Documents/Lanphere_Experiments/wind_experiment/data/wind_plant_info.csv")
##### Merge datasets
wind_CN_data <- merge(wind_plant_info, combined, by.x = "plant.id", by.y = "sample.id", all.y = TRUE) # retain all of C_N data
dim(wind_CN_data)
duplicated(wind_CN_data$plant.id) # there are a few duplicates
which(duplicated(wind_CN_data$plant.id))
wind_CN_data$plant.id[which(duplicated(wind_CN_data$plant.id))]
summarizeCN <- summarySE(data = wind_CN_data, measurevar = "C_N", groupvars = c("treatment","genotype")) # note that sample sizes are quite low for some of the genotypes
ggplot(data = summarizeCN, aes(x = treatment, y = C_N, group = genotype, color = genotype)) + geom_line()
hist(wind_CN_data$C_N) # pretty broad distribution
hist(log(wind_CN_data$C_N))
hist(log(wind_CN_data$C_N))
ggpairs(wind_CN_data[ ,c("C.weight.percent", "N.weight.percent", "C_N")])
plot(log(C_N) ~ genotype, wind_CN_data)
plot(C_N ~ genotype, wind_CN_data)
plot(C_N ~ treatment, wind_CN_data)
plot(C_N ~ as.factor(block), wind_CN_data)
with(wind_CN_data, table(genotype, treatment))
aov_C_N <- aov(log(C_N) ~ genotype * treatment + Error(as.factor(block)/treatment), data= wind_CN_data, qr=TRUE)
summary(aov_C_N)
plot(aov_C_N)
Anova(aov_C_N)
library(cars)
library(car)
Anova(aov_C_N)
plot(C_N ~ genotype, wind_CN_data)
plot(log(C_N) ~ genotype, wind_CN_data)
plot(C_N ~ genotype, wind_CN_data)
